# Gunakan base image resmi Home Assistant
ARG BUILD_FROM=ghcr.io/hassio-addons/base:15.0.6
FROM ${BUILD_FROM}

# Pastikan Python dan pip tersedia
RUN apk add --no-cache python3 py3-pip

# Set direktori kerja di dalam container
WORKDIR /app

# Salin seluruh file dari folder addon ke /app di container
COPY . /app

# Beri izin eksekusi untuk script utama
RUN chmod +x /app/run.sh
RUN chmod +x /app/run.py

# Jalankan instalasi dependensi (jika ada)
RUN pip install --no-cache-dir -r requirements.txt || true

# Entry point â€” yang akan dijalankan saat addon start
CMD [ "/app/run.sh" ]
